extends: [[vacuum:oas, off]]
rules:
  "paths-kebab-case": true
  "path-no-redundant-prefixes":
    description: "Не следует использовать избыточные термины в методах, не относящиеся к смыслу ресурса/команды"
    given: "$.paths[*]~"
    severity: "warn"
    then:
      function: "pattern"
      functionOptions:
        notMatch: ".*?((api)|(http)|(service)).*?"
  "query-params-camel-case":
    description: "Для query параметров запроса используем camelCase"
    given: "$.paths..parameters[?(@.in=='query')].name"
    severity: "warn"
    then:
      function: "casing"
      functionOptions:
        type: "camel"
  "body-fields-camel-case":
    description: "Для именования полей тела запроса используем camelCase"
    given: "$..requestBody..properties[*]~"
    severity: "warn"
    then:
      function: "casing"
      functionOptions:
        type: "camel"
  "method-operation-id-camel-case":
    description: "Для именования operationId используем camelCase"
    given: "$..operationId"
    severity: "warn"
    then:
      function: "casing"
      functionOptions:
        type: "camel"
  "method-request-response-components":
    description: "Тело запроса и ответа должны быть вынесены в components и ссылаться через $ref"
    # TODO не сработает, если варианты responses или само значение requestBody вынесены через $ref
    given: "$..content..schema"
    severity: "warn"
    then:
      field: "$ref"
      function: "truthy"
    resolved: false
  "object-request-response-postfix":
    description: "Объекты запросов и ответов именуются стилем PascalCase с постфиксами Request/Response"
    # TODO не сработает, если варианты responses или само значение requestBody вынесены через $ref
    given: "$..content..schema['$ref']"
    severity: "warn"
    then:
      function: "pattern"
      functionOptions:
        match: ".*?([A-Z][a-z0-9]+)+((Request)|(Response))$"
    resolved: false
